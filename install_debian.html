
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>Baruwa:: A web 2.0 MailScanner frontend | Baruwa on Ubuntu/Debian</title>
	<link rel="icon" href="_static/favicon.ico" type="image/x-icon" />
	<link rel="shortcut icon" href="_static/favicon.ico" type="image/x-icon" />
	<link rel="stylesheet" href="_static/reset.css" type="text/css" media="screen" title="no title" charset="utf-8" />
	<link rel="stylesheet" href="_static/text.css" type="text/css" media="screen" title="no title" charset="utf-8" />
	<link rel="stylesheet" href="_static/960.css" type="text/css" media="screen" title="no title" charset="utf-8" />
	<!--<link rel="stylesheet" href="_static/pygments.css" type="text/css" media="screen" title="no title" charset="utf-8" />-->
	<link rel="stylesheet" href="_static/baruwa.css" type="text/css" media="screen" title="no title" charset="utf-8" />
	<script src="_static/jquery.js" type="text/javascript"></script>
	<script src="_static/hosted.js" type="text/javascript"></script>
	<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-261565-4']);
	_gaq.push(['_trackPageview']);
	</script>
</head>
<body>
	<div id="wrap" class="container_16">
		<div id="header" class="grid_16">
			<div id="log" class="grid_8"><img src="_static/logo.png" alt="Baruwa" /></div>
		</div>
		<div id="navigation" class="grid_16"><ul>
	<li><a href="http://www.baruwa.org/">Home</a></li>
	<li><a href="http://www.baruwa.org/about/">About</a>
	<ul>
		<li><a href="http://www.baruwa.org/about/features.html">Features</a></li>
		<li><a href="http://www.baruwa.org/about/screenshots.html">Screenshots</a></li>
		<li><a href="http://www.baruwa.org/about/requirements.html">Requirements</a></li>
	</ul>
	</li>
	<li><a href="http://www.baruwa.org/blog/">Blog</a></li>
	<li><a href="http://www.baruwa.org/documentation/">Documentation</a>
		<ul>
			<li><a href="http://www.baruwa.org/documentation/">Read online</a></li>
			<li><a href="http://www.baruwa.org/documentation/#downloads">Download</a></li>
			<li><a href="https://github.com/akissa/baruwa/wiki">Wiki</a></li>
			<li><a href="http://www.baruwa.org/documentation/#mirrors">Mirrors</a></li>
		</ul>
	</li>
	<li><a href="http://www.baruwa.org/community/">Community</a></li>
	<li><a href="http://www.baruwa.org/download/">Download</a></li>
	<li><a href="http://www.baruwa.org/development/">Development</a></li>
	<li><a href="http://www.baruwa.org/support/">Support</a>
		<ul>
			<li><a href="http://www.baruwa.org/support/">Free support</a></li>
			<li><a href="http://www.baruwa.org/support/">Commercial support</a></li>
		</ul>
	</li>
</ul>
		</div>
		<div class="clear">&nbsp;</div>
		<div id="main" class="grid_16 featured">
			<div class="grid_15"><h1>Baruwa Documentation: 1.1.1</h1></div>
		</div>
		<div id="holder" class="grid_16">
			<div id="sidebar" class="grid_3">
<h3>Site Search</h3>
<form action="http://www.google.com/cse" id="cse-search-box">
<div>
   	<input type="hidden" name="cx" value="partner-pub-3001556624430247:g7zpfj4e9qx" />
    <input type="hidden" name="ie" value="ISO-8859-1" />
    <input type="text" name="q" size="15" /><input type="submit" name="sa" value="Go" />
</div>
</form>

  <h3><a href="index.html">Docs Home</a></h3>
  <ul>
<li><a class="reference internal" href="#">Baruwa on Ubuntu/Debian</a><ul>
<li><a class="reference internal" href="#install-configure-rabbitmq">Install &amp; Configure RabbitMQ</a></li>
<li><a class="reference internal" href="#configure-rabbitmq">Configure RabbitMQ</a></li>
<li><a class="reference internal" href="#baruwa-apt-install">Baruwa Apt install</a></li>
<li><a class="reference internal" href="#automated-configuration">Automated configuration</a></li>
<li><a class="reference internal" href="#configure-mailscanner">Configure MailScanner</a></li>
<li><a class="reference internal" href="#configure-baruwa">Configure Baruwa</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="install_fedora.html"
                        title="previous chapter">Baruwa on Fedora</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="authentication.html"
                        title="next chapter">External authentication</a></p><h3>Download docs</h3>
<ul>
	<li><a href="http://topdog-software.com/oss/baruwa/1.1.1/docs/baruwa.pdf">PDF</a></li>
	<li><a href="http://topdog-software.com/oss/baruwa/1.1.1/docs/baruwa.epub">EPUB</a></li>
</ul><h3>Support Baruwa</h3>
<p>
	Your generous donations help fund future development.
</p>
<p>
<a href='http://www.pledgie.com/campaigns/12056'>
	<img alt='make a donation at www.pledgie.com !' src="_static/paypal-donate.png" border='0' />
	<img alt='make a donation at www.pledgie.com !' src="_static/visa.png" border='0' />
	<img alt='make a donation at www.pledgie.com !' src="_static/mastercard.png" border='0' />
</a>
</p>
<h3>Ads</h3>
<div>
	<script type="text/javascript"><!--
	google_ad_client = "pub-3001556624430247";
	/* Docs */
	google_ad_slot = "9418887640";
	google_ad_width = 120;
	google_ad_height = 240;
	//-->
	</script>
	<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
</div>
<div>&nbsp;</div>
			</div>
			<div id="content" class="grid_12">
				
  <div class="section" id="baruwa-on-ubuntu-debian">
<span id="installdeb"></span><h1>Baruwa on Ubuntu/Debian</h1>
<p>As of Baruwa 1.1.0 an Apt repo is provided to enable users of Ubuntu and
Debian to install Baruwa using apt-get.</p>
<div class="section" id="install-configure-rabbitmq">
<h2>Install &amp; Configure RabbitMQ</h2>
<p>Install RabbitMQ:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># apt-get install rabbitmq-server</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-rabbitmq">
<h2>Configure RabbitMQ</h2>
<p>Create a user and virtual host for baruwa:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># rabbitmqctl add_user baruwa your_password</span>
<span class="c"># rabbitmqctl add_vhost baruwa</span>
<span class="c"># rabbitmqctl set_permissions -p baruwa baruwa &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span>
</pre></div>
</div>
<p>Delete the guest user:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># rabbitmqctl delete_user guest</span>
</pre></div>
</div>
<p>See the RabbitMQ <a class="reference external" href="http://www.rabbitmq.com/admin-guide.html">Admin Guide</a> for more information.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please ensure that you control access to your RabbitMQ install
as to prevent an unauthorized clients from accessing your broker.</p>
</div>
</div>
<div class="section" id="baruwa-apt-install">
<h2>Baruwa Apt install</h2>
<p>The Baruwa Apt server is located at <a class="reference external" href="http://apt.baruwa.org/">http://apt.baruwa.org/</a></p>
<p>To install from this server you need to enable it by adding
its gpg key and adding it to your /etc/apt/sources.list file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># wget -O - http://apt.baruwa.org/baruwa-apt-keys.gpg | apt-key add -</span>
</pre></div>
</div>
<p>Then add the following to your sources file</p>
<p>debian:</p>
<div class="highlight-python"><pre>deb http://apt.baruwa.org/debian "dist" main</pre>
</div>
<p>Replace <cite>&#8220;dist&#8221;</cite> with the name of the release you are running: (squeeze, wheezy, sid)</p>
<p>ubuntu:</p>
<div class="highlight-python"><pre>deb http://apt.baruwa.org/ubuntu "dist" main</pre>
</div>
<p>Replace <cite>&#8220;dist&#8221;</cite> with the name of the release you are running: (lucid, maverick, natty oneiric)</p>
<p>You can now install Baruwa from the APT repo:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># apt-get update</span>
<span class="c"># apt-get install baruwa</span>
</pre></div>
</div>
</div>
<div class="section" id="automated-configuration">
<h2>Automated configuration</h2>
<p>The installation process will also configure apache, mysql and baruwa should you choose
let the install configure the system for you.</p>
<p>The install asks you for the following info</p>
<blockquote>
<div><ul class="simple">
<li>apache virtualhost name (The name used to configure the baruwa apache virtualhost)</li>
<li>database host (The hostname or ip of the host running your mysql database)</li>
<li>database admin user (A user account with admin access on the database server)</li>
<li>database admin password (The password fo the above user)</li>
<li>database user (The user baruwa will use to connect to the database)</li>
<li>database password (The password for the above)</li>
<li>database name (The name of the baruwa database)</li>
<li>rabbitmq host (The rabbitMQ hostname or IP address)</li>
<li>rabbitmq vhost (The RabbitMQ vhost)</li>
<li>rabbitmq user (The RabbitMQ user)</li>
<li>rabbitmq password (The RabbitMQ password)</li>
<li>baruwa admin user (The baruwa admin user)</li>
<li>baruwa admin password (The baruwa admin user password)</li>
<li>baruwa admin email (The baruwa admin user email address)</li>
</ul>
</div></blockquote>
<p>Populate the database:</p>
<div class="highlight-python"><pre># baruwa-admin syncdb --noinput
# for name in  $(echo "accounts messages lists reports status fixups config"); do
        baruwa-admin migrate $name;
  done</pre>
</div>
<p>Create the admin user account:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># baruwa-admin createsuperuser</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-mailscanner">
<h2>Configure MailScanner</h2>
<p>It is assumed that you have a working MailScanner system already configured,
if you are installing from scratch please refer to their documentation on how
to configure MailScanner. The Baruwa repo includes mailscanner and it will be
installed automatically when you install baruwa.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Starting with Baruwa version 1.1.0 you no longer have to edit and set the
DB authentication details in each and every Custom module, you just set them
up once in the MailScanner configuration file, A Baruwa MailScanner
configuration file is installed as /etc/MailScanner/conf.d/baruwa.conf</p>
</div>
<p>Edit the provided Baruwa MailScanner config file /etc/MailScanner/conf.d/baruwa.conf,
you need to make sure the following options are correct:</p>
<div class="highlight-python"><pre>Quarantine User = exim #(Or what ever your `Run As User` is set to)
DB DSN = DBI:mysql:database=baruwa;host=spam01;port=3306 #set to valid DSN
DB Username = baruwa # your DB username
DB Password = password # your DB password</pre>
</div>
<p>To actually quarantine and later process messages with in Baruwa, set
<cite>store</cite> as one of your keywords for the <cite>Spam Actions</cite> and
<cite>High Scoring Spam Actions</cite> MailScanner options.</p>
<p>The provided MailScanner configuration provides for SQL logging, Whitelists and
Blacklists and Per user settings.</p>
<p><strong>Apply configuration changes</strong></p>
<p>Test your configuration for any errors:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># MailScanner --lint</span>
</pre></div>
</div>
<p>Restart MailScanner:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># /etc/init.d/mailscanner restart</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-baruwa">
<h2>Configure Baruwa</h2>
<p>Edit the settings.py file and make configuration changes to suit your site.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># vi /etc/baruwa/settings.py</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Make sure you change the SECRET_KEY, DO NOT USE THE DEFAULT, If you have a cluster the key
should be the same on all the machines in the cluster.</p>
</div>
<p><strong>Configure Email Signature management</strong></p>
<p>Baruwa now supports the management of email signatures / disclaimers
from within the web interface. Signatures are configured on a domain
and user level.</p>
<p>Both HTML and text signatures are supported, HTML signatures support
embedding of one graphical image, which can be uploaded via the HTML
editor interface.</p>
<p>The backend that handles the signatures needs to be initialized before
you can begin to manage the signatures via the interface.</p>
<p>To initialize the backend run:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># baruwa-admin initconfig</span>
</pre></div>
</div>
<p>This will ask you for the hostname of the system you are setting up,
and then initialize the system for you. The command does attempt to
guess your hostname, so if its correct just press enter.</p>
<p>You need to initialize each of your machines if you are running a
clustered setup.</p>
</div>
<div class="section" id="testing">
<h2>Testing</h2>
<p><strong>Verify that is working</strong></p>
<p>Check your log files you should see</p>
<p>Baruwa SQL logger:</p>
<div class="highlight-python"><pre>Aug  9 18:58:27 localhost MailScanner[8470]: Logging message 1OiVg7-0003zS-9s to Baruwa SQL
Aug  9 18:58:27 localhost MailScanner[11052]: 1OiVg7-0003zS-9s: Logged to Baruwa SQL</pre>
</div>
<p>Baruwa Lists:</p>
<div class="highlight-python"><pre>Aug 9 18:32:42 localhost MailScanner[27260]: Starting Baruwa whitelists
Aug 9 18:32:42 localhost MailScanner[27260]: Read 6 whitelist items
Aug 9 18:32:42 localhost MailScanner[27260]: Ip blocks whitelisted 192.168.1.0/24 192.168.2.0/24
xxx.xx.xxx.0/26</pre>
</div>
<p>Baruwa User settings:</p>
<div class="highlight-python"><pre>Aug 9 15:00:03 localhost MailScanner[25708]: Baruwa - Populating spam score settings
Aug 9 15:00:03 localhost MailScanner[25708]: Read 1 spam score settings
Aug 9 14:59:53 localhost MailScanner[25668]: Baruwa - Populating high spam score settings
Aug 9 14:59:53 localhost MailScanner[25668]: Read 1 high spam score settings</pre>
</div>
<p>Point your browser to <a class="reference external" href="http://hostname_used">http://hostname_used</a> login with admin user and password
and start working. You can now use the interface to add users, domains and
process messages, etc etc.</p>
</div>
</div>


			</div>
		</div>
		<div id="footer" class="grid_16"><div id="sitemap" class="grid_16">
    <div id="sitelinks" class="grid_3">
        <h4>About</h4>
        <ul>
            <li><a href="http://www.baruwa.org/about/">Introduction</a></li>
            <li><a href="http://www.baruwa.org/about/features.html">Features</a></li>
            <li><a href="http://www.baruwa.org/about/screenshots.html">Screenshots</a></li>
            <li><a href="http://www.baruwa.org/about/requirements.html">Requirements</a></li>
            <li><a href="http://www.baruwa.org/download/">Downloads</a></li>
			<li><a href="http://www.pledgie.com/campaigns/12056">Donations</a></li>
        </ul>
    </div>
    <div id="supportlinks" class="grid_4">
        <h4>Support</h4>
        <ul>
            <li><a href="http://www.baruwa.org/community/#mlist">Mailing list</a></li>
            <li><a href="http://www.baruwa.org/community/#irc">IRC</a></li>
            <li><a href="https://github.com/akissa/baruwa/issues">Issue tracker</a></li>
            <li><a href="http://www.baruwa.org/support/">Commercial support</a></li>
        </ul>
    </div>
    <div id="doclins" class="grid_4">
        <h4>Documentation</h4>
        <ul>
            <li><a href="http://www.baruwa.org/documentation/">Read online</a></li>
            <li><a href="http://www.baruwa.org/documentation/#downloads">Download</a></li>
            <li><a href="http://www.baruwa.org/community/#wiki">Wiki</a></li>
            <li><a href="http://www.baruwa.org/documentation/#mirrors">Mirrors</a></li>
            <li><a href="http://www.baruwa.org/blog/">Blog</a></li>
        </ul>
    </div>
    <div id="search" class="grid_4">
		<h4>Documentation Quick links</h4>
		<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#features">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#screenshots">Screenshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Source Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_centos.html">Baruwa on RHEL/SL/Centos</a></li>
<li class="toctree-l1"><a class="reference internal" href="install_fedora.html">Baruwa on Fedora</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Baruwa on Ubuntu/Debian</a></li>
<li class="toctree-l1"><a class="reference internal" href="authentication.html">External authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="integration.html">MTA Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed_setup.html">Clustered setups</a></li>
<li class="toctree-l1"><a class="reference internal" href="batteries_included.html">Other batteries included</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Getting Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contributing to Baruwa</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Migrate from Mailwatch</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="old.html">Older documentation</a></li>
</ul>

    </div>
</div>
<div class="clear">&nbsp;</div>
<div class="grid_16" id="copylinks">
<div id="copy-left" class="grid_8">
    <span>Follow Baruwa...</span>
    <a href="http://www.baruwa.org/blog/feed/index.xml"><img src="_static/feed.png" alt="RSS feeds"  title="Baruwa RSS feeds" /></a>
    <a href="http://identi.ca/baruwa"><img src="_static/identi.png" alt="Identi"  title="Baruwa on Identi" /></a>
    <a href="http://twitter.com/baruwaproject"><img src="_static/twitter.png" alt="twitter"  title="Baruwa on Twitter" /></a>
    <a href="http://www.facebook.com/share.php?u=http://www.baruwa.org/install_debian.html&amp;t=Baruwa"><img src="_static/facebook.png" alt="facebool"  title="Baruwa on Facebook" /></a>
    <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://www.baruwa.org/install_debian.html"><img src="_static/linkedin.png" alt="linkedin"  title="Baruwa on Linkedin" /></a>
    <a href="http://www.flickr.com/photos/baruwa"><img src="_static/flickr.png" alt="flickr"  title="Baruwa on Flickr" /></a>
    <a href="http://delicious.com/save?v=5&amp;url=http://www.baruwa.org/install_debian.html&amp;title=Baruwa"><img src="_static/delicious.png" alt="delicious"  title="Baruwa on delicious" /></a>
    <a href="http://www.stumbleupon.com/submit?url=http://www.baruwa.org/install_debian.html"><img src="_static/stumble.png" alt="stumbleupon" title="Baruwa on stumbleupon" /></a>
    <a href="http://reddit.com/submit?url=http://www.baruwa.org/install_debian.html"><img src="_static/reddit.png" alt="reddit" title="Add to reddit" /></a>
    <a href="http://github.com/akissa/baruwa"><img src="_static/github.png" alt="Github" title="Baruwa on Github" /></a>
    <a href="http://freshmeat.net/projects/baruwa"><img src="_static/fm.png" alt="Freshmeat" title="Baruwa on Freshmeat" /></a>
    <a href="http://www.pledgie.com/campaigns/12056"><img src="_static/paypal.png" alt="Donate"  title="Donate to Baruwa" /></a>
</div>
<div id="copy-right" class="grid_7">&copy; Copyright 2010, Andrew Colin Kissa.
</div>
</div>
		</div>
	</div>
	<script type="text/javascript">
	(function() {
	var ga = document.createElement('script');
	ga.src = ('https:' == document.location.protocol ?
	'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	ga.setAttribute('async', 'true');
	document.documentElement.firstChild.appendChild(ga);
	})();
	</script>
	<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
</body>
</html>